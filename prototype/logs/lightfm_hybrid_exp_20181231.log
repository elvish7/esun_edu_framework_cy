/usr/local/lib/python3.8/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  mask |= (ar1 == a)
==========(1) Load Interaction ==========             
Time cost: None            
Memory cost: None            
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 73189                     
	num items: 2258                    
	num interaction: 1954097                     
	num interaction (aggregated): 196347                     
	average subscribing times: 26.699326401508422                    
	average regular-subscribing times: 24.97569306863053                    
	average solo-subscribing times: 1.7236333328778914                    
	average subscribed items: 2.6827392094440423                    
	average regular-subscribed ratio: 0.5169345814824534                    
	average solo-subscribed ratio: 0.4671715111268988                    
	average mixed-subscribed ratio: 0.015893907390647794                    
})             
=======================
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 35553                     
	num items: 1695                    
	num interaction: 96944                     
	num interaction (aggregated): 66685                     
	average subscribing times: 2.7267459848676623                    
	average regular-subscribing times: 2.5983180041065452                    
	average solo-subscribing times: 0.1284279807611172                    
	average subscribed items: 1.8756504373751863                    
	average regular-subscribed ratio: 0.9220547098700842                    
	average solo-subscribed ratio: 0.0763653551435173                    
	average mixed-subscribed ratio: 0.0015799349863985757                    
})
332 NA values in column gender_code are replaced by F
42 NA values in column income_range_code are replaced by 1.0
6 NA values in column risk_type_code are replaced by 03
User({                
	num_users: 73589                 
	num_item_metas: 5                 
	num_item_features: 15                 
})
Item({                
	num_items: 4168                 
	num_item_metas: 4                 
	num_item_features: 26                 
})
Building interaction and user/item feature matrices ...

Building matrices from 'interactions' data by key 'ratings'
Building matrices from 'interactions' data by key 'ratings'
RecDataset({                
	split: ['train', 'eval'],                
	num_users: 73589                 
	num_items: 4168                
	num_user_features: 15                
	num_item_features: 26                
})
**** cold-start users and item in this dataset ****                 
 - Number of non-interacted users: 867                 
 - Number of non-interacted items: 1901
[0 2 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
DiffMatrix({                    
	base: 65229                    
	reference: 194882                    
	intersection: 62403                    
	same: 62403                    
	difference: 2826                    
})
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
DiffMatrix({                    
	base: 62403                    
	reference: 97339                    
	intersection: 59054                    
	same: 59054                    
	difference: 3349                    
})
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
RecTrainer({                
	model: LightFM                
	model type: hybrid                
	model path: models/lightfm                
	average_subscribing_times: None                
})
***** Epoch: 1 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.0966
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.1196
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.0933
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.1187
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.0629
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0483
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.1874
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.2083
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 2 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.1626
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.1083
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.1569
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.1073
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.0893
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0469
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.2807
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.2019
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 3 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.2203
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.1083
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2121
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.1075
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1119
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0440
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.3705
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1908
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 4 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.2744
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0920
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2635
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0915
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1324
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0383
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.4470
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1669
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 5 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.3130
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0851
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3001
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0846
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1456
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0359
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.4984
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1569
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 6 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.3532
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0725
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3375
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0722
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1588
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0315
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.5425
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1373
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 7 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.3803
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0710
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3623
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0708
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1671
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0306
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.5699
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1351
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 8 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.4168
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0700
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3955
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0698
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1779
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0305
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.6028
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1347
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 9 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.4444
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0638
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.4203
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0635
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1860
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0280
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.6276
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1222
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 10 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.4656
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0592
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.4389
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0591
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1936
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0263
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.6493
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1151
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
