==========(1) Load Interaction ==========             
Time cost: None            
Memory cost: None            
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 70112                     
	num items: 2307                    
	num interaction: 1845464                     
	num interaction (aggregated): 184438                     
	average subscribing times: 26.321656777727064                    
	average regular-subscribing times: 24.68815609310817                    
	average solo-subscribing times: 1.6335006846188955                    
	average subscribed items: 2.6306195801004106                    
	average regular-subscribed ratio: 0.5323591979410071                    
	average solo-subscribed ratio: 0.4521370562314664                    
	average mixed-subscribed ratio: 0.015503745827526472                    
})             
=======================
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 20191                     
	num items: 1518                    
	num interaction: 114571                     
	num interaction (aggregated): 33480                     
	average subscribing times: 5.674359863305433                    
	average regular-subscribing times: 5.097518696448913                    
	average solo-subscribing times: 0.5768411668565202                    
	average subscribed items: 1.6581645287504334                    
	average regular-subscribed ratio: 0.8535272629521891                    
	average solo-subscribed ratio: 0.1456648570635652                    
	average mixed-subscribed ratio: 0.0008078799842456916                    
})
311 NA values in column gender_code are replaced by F
42 NA values in column income_range_code are replaced by 1.0
8 NA values in column risk_type_code are replaced by 03
User({                
	num_users: 70547                 
	num_item_metas: 5                 
	num_item_features: 15                 
})
Item({                
	num_items: 4168                 
	num_item_metas: 4                 
	num_item_features: 26                 
})
Building interaction and user/item feature matrices ...

Building matrices from 'interactions' data by key 'ratings'
Building matrices from 'interactions' data by key 'ratings'
RecDataset({                
	split: ['train', 'eval'],                
	num_users: 70547                 
	num_items: 4168                
	num_user_features: 15                
	num_item_features: 26                
})
**** cold-start users and item in this dataset ****                 
 - Number of non-interacted users: 862                 
 - Number of non-interacted items: 1790
[0 0 0 1 1 1 0 2 0 1]
[2 0 0 0 0 0 0 0 0]
DiffMatrix({                    
	base: 31934                    
	reference: 183091                    
	intersection: 27622                    
	same: 27622                    
	difference: 4312                    
})
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 1 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
DiffMatrix({                    
	base: 27622                    
	reference: 93378                    
	intersection: 26257                    
	same: 26257                    
	difference: 1365                    
})
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
RecTrainer({                
	model: LightFM                
	model type: hybrid                
	model path: models/lightfm                
	average_subscribing_times: None                
})
***** Epoch: 1 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.0482
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0073
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.1552
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0285
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.0821
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0141
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.0799
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0141
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 2 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.0685
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0073
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.2339
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0286
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.1326
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0146
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.1292
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0146
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 3 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.0903
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0062
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.3236
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0251
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.1905
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0113
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.1854
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0113
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 4 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1059
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0062
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.3864
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0246
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.2355
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0110
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2287
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0109
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 5 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1167
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0064
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.4281
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0254
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.2656
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0108
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2574
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0107
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 6 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1260
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0061
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.4627
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0242
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.2984
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0100
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2886
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0099
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 7 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1330
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0064
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.4872
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0258
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.3228
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0106
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3115
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0105
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 8 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1395
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0061
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.5101
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0242
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.3457
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0101
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3327
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0100
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 9 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
/usr/local/lib/python3.8/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  mask |= (ar1 == a)
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1444
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0060
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.5278
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0239
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.3651
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0097
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3505
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0096
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

***** Epoch: 10 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4166 4166 4167 4167 4166 4167 4166]
[4166 4167 4167 4167 4167 4167 4167 4167 4167]
[0 0 0 1 1 0 0 1 0 1]
[1 0 0 0 0 0 0 0 0]
[0 0 0 1 1 0 0 0 0 1]
[0 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 1 0 0]
[1 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 19063   (1.6752)
 [eval-exploit        ]: 16828   (1.6414)
 [eval-explore        ]: 3363    (1.2822)
 [eval-exploit-R2*    ]: 16090   (1.6319)
 [eval-exploit-S2*    ]: 1176    (1.1607)
==========================================
  P@5   on eval                : 0.1501
  P@5   on eval-exploit        : 0.3150
  P@5   on eval-explore        : 0.0053
  P@5   on eval-exploit-R2*    : 0.3135
  P@5   on eval-exploit-S2*    : 0.2311
  R@5   on eval                : 0.5465
  R@5   on eval-exploit        : 1.0000
  R@5   on eval-explore        : 0.0212
  R@5   on eval-exploit-R2*    : 1.0000
  R@5   on eval-exploit-S2*    : 1.0000
  mAP@5 on eval                : 0.3826
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0092
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3667
  mRR@5 on eval-exploit        : 0.8893
  mRR@5 on eval-explore        : 0.0090
  mRR@5 on eval-exploit-R2*    : 0.8904
  mRR@5 on eval-exploit-S2*    : 0.9661
=================================

Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
