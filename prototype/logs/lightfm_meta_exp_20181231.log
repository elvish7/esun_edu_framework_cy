/usr/local/lib/python3.8/dist-packages/numpy/lib/arraysetops.py:569: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  mask |= (ar1 == a)
==========(1) Load Interaction ==========             
Time cost: None            
Memory cost: None            
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 73189                     
	num items: 2258                    
	num interaction: 1954097                     
	num interaction (aggregated): 196347                     
	average subscribing times: 26.699326401508422                    
	average regular-subscribing times: 24.97569306863053                    
	average solo-subscribing times: 1.7236333328778914                    
	average subscribed items: 2.6827392094440423                    
	average regular-subscribed ratio: 0.5169345814824534                    
	average solo-subscribed ratio: 0.4671715111268988                    
	average mixed-subscribed ratio: 0.015893907390647794                    
})             
=======================
Interaction({                    
	start date: None                    
	end date: None                    
	num users: 35553                     
	num items: 1695                    
	num interaction: 96944                     
	num interaction (aggregated): 66685                     
	average subscribing times: 2.7267459848676623                    
	average regular-subscribing times: 2.5983180041065452                    
	average solo-subscribing times: 0.1284279807611172                    
	average subscribed items: 1.8756504373751863                    
	average regular-subscribed ratio: 0.9220547098700842                    
	average solo-subscribed ratio: 0.0763653551435173                    
	average mixed-subscribed ratio: 0.0015799349863985757                    
})
332 NA values in column gender_code are replaced by F
42 NA values in column income_range_code are replaced by 1.0
6 NA values in column risk_type_code are replaced by 03
User({                
	num_users: 73589                 
	num_item_metas: 5                 
	num_item_features: 15                 
})
Item({                
	num_items: 4168                 
	num_item_metas: 4                 
	num_item_features: 26                 
})
Building interaction and user/item feature matrices ...

Building matrices from 'interactions' data by key 'ratings'
Building matrices from 'interactions' data by key 'ratings'
RecDataset({                
	split: ['train', 'eval'],                
	num_users: 73589                 
	num_items: 4168                
	num_user_features: 15                
	num_item_features: 26                
})
**** cold-start users and item in this dataset ****                 
 - Number of non-interacted users: 867                 
 - Number of non-interacted items: 1901
[0 2 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
DiffMatrix({                    
	base: 65229                    
	reference: 194882                    
	intersection: 62403                    
	same: 62403                    
	difference: 2826                    
})
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
DiffMatrix({                    
	base: 62403                    
	reference: 97339                    
	intersection: 59054                    
	same: 59054                    
	difference: 3349                    
})
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
RecTrainer({                
	model: LightFM                
	model type: cf                
	model path: models/lightfm                
	average_subscribing_times: None                
})
***** Epoch: 1 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.1009
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.1110
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.0969
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.1102
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.0657
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0456
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.1896
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1947
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 2 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.2142
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.1079
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.2050
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.1071
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1108
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0443
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.3426
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1910
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 3 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.3620
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0971
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.3428
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0964
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.1631
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0427
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.5163
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1836
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 4 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.4781
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0803
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.4458
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0797
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2015
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0387
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.6321
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1671
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 5 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.5538
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0739
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.5105
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0733
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2272
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0376
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.7071
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1631
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 6 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.6076
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0688
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.5548
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0685
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2452
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0354
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.7558
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1536
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 7 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.6462
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0630
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.5859
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0626
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2581
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0336
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.7908
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1455
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 8 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.6739
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0601
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.6077
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0599
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2676
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0330
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.8145
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1433
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 9 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.6953
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0588
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.6241
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0585
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2748
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0319
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.8321
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1395
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

***** Epoch: 10 *****
[4167 4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4167 4167 4167 4167 4167 4167 4167 4167]
[4167 4166 4166 4166 4166 4167 4166 4167 4167 4166]
[4167 4167 4167 4167 4167 4166 4167 4167 4167]
[0 1 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 0 1 1 1 0 1 0 0 1]
[0 0 0 0 0 1 0 0 0]
[0 1 0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0 0]
==========================================
 [eval                ]: 34535   (1.8888)
 [eval-exploit        ]: 33355   (1.8709)
 [eval-explore        ]: 2305    (1.2260)
 [eval-exploit-R2*    ]: 31763   (1.8592)
 [eval-exploit-S2*    ]: 2747    (1.2191)
==========================================
  mAP@5 on eval                : 0.7106
  mAP@5 on eval-exploit        : 1.0000
  mAP@5 on eval-explore        : 0.0553
  mAP@5 on eval-exploit-R2*    : 1.0000
  mAP@5 on eval-exploit-S2*    : 1.0000
  mRR@5 on eval                : 0.6354
  mRR@5 on eval-exploit        : 0.8578
  mRR@5 on eval-explore        : 0.0551
  mRR@5 on eval-exploit-R2*    : 0.8586
  mRR@5 on eval-exploit-S2*    : 0.9548
  precision@5 on eval                : 0.2805
  precision@5 on eval-exploit        : 0.3523
  precision@5 on eval-explore        : 0.0307
  precision@5 on eval-exploit-R2*    : 0.3508
  precision@5 on eval-exploit-S2*    : 0.2424
  recall@5 on eval                : 0.8455
  recall@5 on eval-exploit        : 1.0000
  recall@5 on eval-explore        : 0.1344
  recall@5 on eval-exploit-R2*    : 1.0000
  recall@5 on eval-exploit-S2*    : 1.0000
=================================

Evaluation({                
	evaluating sets: dict_keys(['eval', 'eval-exploit', 'eval-explore', 'eval-exploit-R2*', 'eval-exploit-S2*']),                
})
